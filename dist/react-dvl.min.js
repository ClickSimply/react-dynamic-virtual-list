!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("react"));else if("function"==typeof define&&define.amd)define(["react"],t);else{var i="object"==typeof exports?t(require("react")):t(e.react);for(var o in i)("object"==typeof exports?exports:e)[o]=i[o]}}(window,function(e){return function(e){var t={};function i(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(t,i){t.exports=e},function(e,t,i){"use strict";var o,s=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),n={opacity:0,height:0},a=function(e){function t(t){var i=e.call(this,t)||this;return i.buffer=5,i.itemHeight=[],i.itemRows=[],i.batchCounter=0,i.counter=0,i.id=Math.random(),i.reflowLayout=i.reflowLayout.bind(i),i.debounceResize=i.debounceResize.bind(i),i.calcVisible=i.calcVisible.bind(i),i.scheduleVisibleUpdate=i.scheduleVisibleUpdate.bind(i),i.rowCache=[],i.firstRender=0,i.hasWin="undefined"!=typeof window,i.state={loading:!1,progress:0,scrollHeight:0,topSpacer:0,batch:0,renderRange:[],columns:0},i}return s(t,e),t.prototype.componentWillMount=function(){void 0!==this.props.buffer&&(this.buffer=this.props.buffer),this.props.doUpdate&&this.props.doUpdate(this.calcVisible),this.reflowLayout(),this.hasWin&&"number"!=typeof this.props.calculateHeight&&window.addEventListener("resize",this.debounceResize)},t.prototype.componentWillUnmount=function(){this.hasWin&&"number"!=typeof this.props.calculateHeight&&window.removeEventListener("resize",this.debounceResize)},t.prototype.debounceResize=function(){this.doResize&&clearTimeout(this.doResize),this.doResize=setTimeout(this.reflowLayout,250)},t.prototype.reflowLayout=function(){var e=this;this.props.onResizeStart&&this.props.onResizeStart(),this.counter=0,setTimeout(function(){e.itemHeight=[],e.itemRows=[],e.setState({loading:!0,scrollHeight:0,topSpacer:0,batch:0},function(){var t=e.props.calculateHeight;void 0!==t&&(e.props.items.forEach(function(i,o){e.itemHeight[o]="number"==typeof t?t:t(e.ref,i,o)}),e.reflowComplete(!0))})},this.props.onResizeStart?20:0)},t.prototype.reflowComplete=function(e){var t=this,i=0,o=Math.floor(this.ref.clientWidth/(this.props.gridItemWidth||100)),s=[],r=0,n=this.state.progress,a=this.itemHeight.reduce(function(e,a,p){return n&&p>n-1?e:t.props.gridItemWidth?(p%o==0&&(i=0),t.rowCache[p]=r,i=Math.max(i,t.itemHeight[p]),p%o==o-1?(s[r]=i,r++,e+i):p===t.itemHeight.length-1?(s[r]=i,e+i):e):e+a},0);if(this.props.gridItemWidth?this.itemRows=s:this.itemRows=this.itemHeight,e)this.setState({loading:!1,columns:o,batch:0,progress:0},function(){t.setState({scrollHeight:a}),t.props.onResizeFinish&&t.props.onResizeFinish(a,o),t.scheduleVisibleUpdate()});else{var p=Math.round(a/n);this.setState({scrollHeight:a+(this.props.items.length-n)*p,columns:o},function(){t.scheduleVisibleUpdate()})}},t.prototype.scheduleVisibleUpdate=function(){var e=this;this.ticking||(this.ticking=!0,window.requestAnimationFrame(function(){e.calcVisible(),e.ticking=!1}))},t.prototype.calcVisible=function(e,t){var i=e||this.ref.scrollTop,o=t||this.ref.clientHeight,s=0;if(this.props.windowContainer&&this.hasWin){var r=this.ref.getBoundingClientRect().top,n=document.documentElement,a=r+(i=(window.pageYOffset||n.scrollTop)-(n.clientTop||0));o=window.innerHeight,s+=i>a?a:i}for(var p=[],c=0;c<this.itemRows.length;){var h=void 0!==p[0],l=void 0!==p[1];h&&l?c=this.itemRows.length:(!h&&s>=i&&(p[0]=c),!l&&h&&s+this.itemRows[c]>i+o&&(p[1]=c),s+=this.itemRows[c],c++)}void 0===p[1]?p[1]=this.itemRows.length-1:p[1]=Math.min(p[1]+this.buffer,this.itemRows.length-1),p[0]=Math.max(0,p[0]-this.buffer);for(var u=0,d=0;d<p[0]&&this.itemRows[d];d++)u+=this.itemRows[d];this.setState({renderRange:p,topSpacer:u})},t.prototype.addEventListener=function(){this.ref&&!this.props.doUpdate&&this.hasWin&&(this.props.windowContainer?window.addEventListener("scroll",this.scheduleVisibleUpdate):this.ref.addEventListener("scroll",this.scheduleVisibleUpdate))},t.prototype.render=function(){var e=this,t=100*this.state.batch,i=t+100,o=0;return r.createElement("div",{className:this.props.containerClass,style:this.props.containerStyle,ref:function(t){t&&t!==e.ref&&(e.ref=t,e.addEventListener(),e.props.containerRef&&e.props.containerRef(t))}},r.createElement("div",{style:{height:this.state.scrollHeight>0?this.state.scrollHeight-this.state.topSpacer:"unset",paddingTop:this.state.topSpacer}},!this.state.loading||this.state.progress?this.props.items.filter(function(t,i){return!(e.state.progress&&i>e.state.progress-1)&&(e.props.gridItemWidth?e.rowCache[i]>=e.state.renderRange[0]&&e.rowCache[i]<=e.state.renderRange[1]:i>=e.state.renderRange[0]&&i<=e.state.renderRange[1])}).map(function(t,i){return e.props.onRender(t,e.state.renderRange[0]+i,e.state.columns)}):null),r.createElement("div",{style:n},this.state.loading?void 0!==this.props.calculateHeight?null:r.createElement("div",null,this.props.items.filter(function(e,o){return o>=t&&o<i}).map(function(i,s){return r.createElement("div",{key:s,ref:function(i){i&&!e.itemHeight[s+t]&&(e.counter++,o++,e.itemHeight[s+t]=i.clientHeight,e.counter===e.props.items.length?e.reflowComplete(!0):100===o&&setTimeout(function(){e.setState({batch:e.state.batch+1,progress:100*(e.state.batch+1)},function(){e.state.loading&&e.reflowComplete(!1)})},0))}},e.props.onRender(i,s))})):null))},t}(r.Component);t.DVL=a}])});