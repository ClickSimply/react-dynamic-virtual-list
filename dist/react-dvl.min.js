!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("React"));else if("function"==typeof define&&define.amd)define(["React"],t);else{var i="object"==typeof exports?t(require("React")):t(e.React);for(var o in i)("object"==typeof exports?exports:e)[o]=i[o]}}(window,function(e){return function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,t){"undefined"!=typeof window&&(window.setImmediate||function(){"use strict";var e=0,t={},i=!0,o=Array.prototype.slice,n="setImmediatePolyfillMessage";function s(e){var i,s=e.data;"string"==typeof s&&0==s.indexOf(n)&&(i=t[s])&&(delete t[s],function(e){var t=e[0];switch(e.length){case 1:return t();case 2:return t(e[1]);case 3:return t(e[1],e[2])}t.apply(window,o.call(e,1))}(i))}window.setImmediate=function(){for(var o=e++,r=n+o,a=arguments.length,c=new Array(a);a--;)c[a]=arguments[a];return t[r]=c,i&&(i=!1,window.addEventListener("message",s)),window.postMessage(r,"*"),o},window.clearImmediate=function(e){delete t[n+e]}}())},function(t,i){t.exports=e},function(e,t,i){"use strict";var o,n=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var s=i(1);i(0);var r={opacity:0,height:0},a=function(e){function t(t){var i=e.call(this,t)||this;return i.buffer=5,i.itemHeight=[],i.itemRows=[],i.batchCounter=0,i.counter=0,i.id=Math.random(),i.reflowLayout=i.reflowLayout.bind(i),i.debounceResize=i.debounceResize.bind(i),i.calcVisible=i.calcVisible.bind(i),i.scheduleVisibleUpdate=i.scheduleVisibleUpdate.bind(i),i.rowCache=[],i.firstRender=0,i.hasWin="undefined"!=typeof window,i.state={loading:!1,progress:0,scrollHeight:0,topSpacer:0,batch:0,renderRange:[],columns:0},i}return n(t,e),t.prototype.componentWillMount=function(){void 0!==this.props.buffer&&(this.buffer=this.props.buffer),this.props.doUpdate&&this.props.doUpdate(this.calcVisible),this.reflowLayout(),this.hasWin&&"number"!=typeof this.props.calculateHeight&&window.addEventListener("resize",this.debounceResize)},t.prototype.componentWillUnmount=function(){this.hasWin&&"number"!=typeof this.props.calculateHeight&&window.removeEventListener("resize",this.debounceResize)},t.prototype.debounceResize=function(){this.doResize&&clearTimeout(this.doResize),this.doResize=setTimeout(this.reflowLayout,250)},t.prototype.reflowLayout=function(){var e=this;this.props.onResizeStart&&this.props.onResizeStart(),this.counter=0,setTimeout(function(){e.itemHeight=[],e.itemRows=[],e.setState({loading:!0,scrollHeight:0,topSpacer:0,batch:0},function(){var t=e.props.calculateHeight;void 0!==t&&(e.props.items.forEach(function(i,o){e.itemHeight[o]="number"==typeof t?t:t(e.ref,i,o)}),e.reflowComplete(!0))})},this.props.onResizeStart?20:0)},t.prototype.reflowComplete=function(e){var t=this,i=0,o=Math.floor(this.ref.clientWidth/(this.props.gridItemWidth||100)),n=[],s=0,r=this.itemHeight.reduce(function(e,r,a){return t.state.progress&&a>t.state.progress-1?e:t.props.gridItemWidth?(a%o==0&&(i=0),t.rowCache[a]=s,i=Math.max(i,t.itemHeight[a]),a%o==o-1?(n[s]=i,s++,e+i):a===t.itemHeight.length-1?(n[s]=i,e+i):e):e+r},0);this.props.gridItemWidth?this.itemRows=n:this.itemRows=this.itemHeight,e?this.setState({loading:!1,scrollHeight:r,columns:o,batch:0,progress:0},function(){t.props.onResizeFinish&&t.props.onResizeFinish(r,o),t.scheduleVisibleUpdate()}):this.setState({scrollHeight:r,columns:o},function(){t.firstRender<2&&(t.scheduleVisibleUpdate(),t.firstRender++)})},t.prototype.scheduleVisibleUpdate=function(){var e=this;this.ticking||(this.ticking=!0,window.requestAnimationFrame(function(){e.calcVisible(),e.ticking=!1}))},t.prototype.calcVisible=function(e,t){var i=e||this.ref.scrollTop,o=t||this.ref.clientHeight,n=0;if(this.props.windowContainer&&this.hasWin){var s=this.ref.getBoundingClientRect().top,r=document.documentElement,a=s+(i=(window.pageYOffset||r.scrollTop)-(r.clientTop||0));o=window.innerHeight,n+=i>a?a:i}for(var c=[],p=0;p<this.itemRows.length;){var h=void 0!==c[0],l=void 0!==c[1];h&&l?p=this.itemRows.length:(!h&&n>=i&&(c[0]=p),!l&&h&&n+this.itemRows[p]>i+o&&(c[1]=p),n+=this.itemRows[p],p++)}void 0===c[1]?c[1]=this.itemRows.length-1:c[1]=Math.min(c[1]+this.buffer,this.itemRows.length-1),c[0]=Math.max(0,c[0]-this.buffer);for(var u=0,d=0;d<c[0]&&this.itemRows[d];d++)u+=this.itemRows[d];this.setState({renderRange:c,topSpacer:u})},t.prototype.addEventListener=function(){this.ref&&!this.props.doUpdate&&this.hasWin&&(this.props.windowContainer?window.addEventListener("scroll",this.scheduleVisibleUpdate):this.ref.addEventListener("scroll",this.scheduleVisibleUpdate))},t.prototype.render=function(){var e=this,t=100*this.state.batch,i=t+100,o=0;return s.createElement("div",{className:this.props.className,style:this.props.style,ref:function(t){t&&t!==e.ref&&(e.ref=t,e.addEventListener(),e.props.ref&&e.props.ref(t))}},s.createElement("div",{style:{height:this.state.scrollHeight>0?this.state.scrollHeight-this.state.topSpacer:"unset",paddingTop:this.state.topSpacer}},!this.state.loading||this.state.progress?this.props.items.filter(function(t,i){return!(e.state.progress&&i>e.state.progress-1)&&(e.props.gridItemWidth?e.rowCache[i]>=e.state.renderRange[0]&&e.rowCache[i]<=e.state.renderRange[1]:i>=e.state.renderRange[0]&&i<=e.state.renderRange[1])}).map(function(t,i){return e.props.onRender(t,e.state.renderRange[0]+i,e.state.columns)}):null),s.createElement("div",{style:r},this.state.loading?void 0!==this.props.calculateHeight?null:s.createElement("div",null,this.props.items.filter(function(e,o){return o>=t&&o<i}).map(function(i,n){return s.createElement("div",{key:n,ref:function(i){var s;i&&!e.itemHeight[n+t]&&(e.counter++,o++,e.itemHeight[n+t]=i.clientHeight,e.counter===e.props.items.length?e.reflowComplete(!0):100===o&&(s=function(){e.setState({batch:e.state.batch+1,progress:100*(e.state.batch+1)},function(){e.reflowComplete(!1)})},"undefined"!=typeof window?window.setImmediate(s):setTimeout(s,0)))}},e.props.onRender(i,n))})):null))},t}(s.Component);t.DVL=a}])});